import { warnOnce } from 'motion-utils';
<<<<<<< HEAD
import { createMotionComponent } from '../../motion/index.mjs';

function createMotionProxy(preloadedFeatures, createVisualElement) {
    if (typeof Proxy === "undefined") {
        return createMotionComponent;
=======

function createDOMMotionComponentProxy(componentFactory) {
    if (typeof Proxy === "undefined") {
        return componentFactory;
>>>>>>> 3d7fa812ab99f39397ab881120138fb7d121cb1e
    }
    /**
     * A cache of generated `motion` components, e.g `motion.div`, `motion.input` etc.
     * Rather than generating them anew every render.
     */
    const componentCache = new Map();
<<<<<<< HEAD
    const factory = (Component, options) => {
        return createMotionComponent(Component, options, preloadedFeatures, createVisualElement);
    };
    /**
     * Support for deprecated`motion(Component)` pattern
     */
    const deprecatedFactoryFunction = (Component, options) => {
        if (process.env.NODE_ENV !== "production") {
            warnOnce(false, "motion() is deprecated. Use motion.create() instead.");
        }
        return factory(Component, options);
=======
    const deprecatedFactoryFunction = (...args) => {
        if (process.env.NODE_ENV !== "production") {
            warnOnce(false, "motion() is deprecated. Use motion.create() instead.");
        }
        return componentFactory(...args);
>>>>>>> 3d7fa812ab99f39397ab881120138fb7d121cb1e
    };
    return new Proxy(deprecatedFactoryFunction, {
        /**
         * Called when `motion` is referenced with a prop: `motion.div`, `motion.input` etc.
         * The prop name is passed through as `key` and we can use that to generate a `motion`
         * DOM component with that name.
         */
        get: (_target, key) => {
            if (key === "create")
<<<<<<< HEAD
                return factory;
=======
                return componentFactory;
>>>>>>> 3d7fa812ab99f39397ab881120138fb7d121cb1e
            /**
             * If this element doesn't exist in the component cache, create it and cache.
             */
            if (!componentCache.has(key)) {
<<<<<<< HEAD
                componentCache.set(key, createMotionComponent(key, undefined, preloadedFeatures, createVisualElement));
=======
                componentCache.set(key, componentFactory(key));
>>>>>>> 3d7fa812ab99f39397ab881120138fb7d121cb1e
            }
            return componentCache.get(key);
        },
    });
}

<<<<<<< HEAD
export { createMotionProxy };
=======
export { createDOMMotionComponentProxy };
>>>>>>> 3d7fa812ab99f39397ab881120138fb7d121cb1e
